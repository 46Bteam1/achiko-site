<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="UTF-8">
<title>리뷰 목록</title>
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script th:src="@{/js/review/review.js}"></script>
<style>
body {
	font-family: Arial, sans-serif;
}

.container {
	max-width: 900px;
	margin: auto;
}

.search-box {
	display: flex;
	justify-content: center;
	align-items: center;
	gap: 10px;
	margin-bottom: 20px;
}

.search-input {
	width: 100%;
	max-width: 400px;
	padding: 10px;
	border-radius: 5px;
	border: 1px solid #ccc;
}

.review-summary {
	font-size: 20px;
	font-weight: bold;
	margin-bottom: 15px;
}

.rating-box {
	display: flex;
	justify-content: space-around;
	align-items: center;
	padding: 15px;
	background-color: #f8f9fa;
	border-radius: 10px;
	margin-bottom: 20px;
	font-size: 16px;
	font-weight: bold;
}

.review-card {
	display: flex;
	justify-content: space-between;
	align-items: flex-start;
	padding: 15px;
	background-color: #ffffff;
	border-radius: 10px;
	border: 1px solid #ddd;
	margin-bottom: 10px;
}

.review-left {
	display: flex;
	align-items: flex-start;
}

.reviewer-img {
	width: 50px;
	height: 50px;
	border-radius: 50%;
	margin-right: 15px;
}

.review-content {
	flex-grow: 1;
}

.review-name {
	font-weight: bold;
}

.review-meta {
	font-size: 14px;
	color: gray;
}

.stars {
	color: #ffcc00;
}

.review-ratings {
	text-align: right;
	min-width: 120px;
	font-weight: bold;
}

.review-ratings p {
	margin: 2px 0;
}

.write-review-btn {
	position: fixed;
	bottom: 20px;
	right: 20px;
	background-color: #007bff;
	color: white;
	border: none;
	padding: 12px 18px;
	font-size: 16px;
	border-radius: 50px;
	cursor: pointer;
	box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.2);
}

.write-review-btn:hover {
	background-color: #0056b3;
}
</style>

</head>

<body>
	<div class="container mt-4">
		<div class="search-box">
			<input type="text" id="searchInput" class="search-input"
				placeholder="리뷰 검색...">
			<button class="btn btn-primary" onclick="searchReviews()">검색</button>
		</div>

		<h3 class="mt-3 text-start">
			<span th:text="${reviewedUserName}"></span>님에 대한 후기 <span
				class="text-muted" style="font-size: 14px;"> (<span
				th:text="${isHost == 0 ? '게스트' : (isHost == 1 ? '호스트' : '관리자')}"></span>
				· <span th:text="${nationality}"></span> · <span
				th:text="${gender == 0 ? '남성' : (gender == 1 ? '여성' : '기타')}"></span>
				· <span th:text="${languages}"></span> · <span th:text="${religion}"></span>)
			</span>
		</h3>
		<p class="text-muted" style="font-size: 14px;" th:text="${bio}"></p>

		<div class="review-summary">
			· 후기 <span th:text="|총 ${#lists.size(reviews)}개|"></span>
		</div>
		<div class="rating-box">
			<div>
				<p>청결도</p>
				<p th:text="${#numbers.formatDecimal(averageCleanliness, 1, 2)}"></p>
			</div>
			<div>
				<p>신뢰도</p>
				<p th:text="${#numbers.formatDecimal(averageTrust, 1, 2)}"></p>
			</div>
			<div>
				<p>소통 능력</p>
				<p th:text="${#numbers.formatDecimal(averageCommunication, 1, 2)}"></p>
			</div>
			<div>
				<p>매너</p>
				<p th:text="${#numbers.formatDecimal(averageManner, 1, 2)}"></p>
			</div>
		</div>

		<div class="review-list">
			<div class="review-card" th:id="|review-${review.reviewId}|"
				th:each="review : ${reviews}">

				<div class="review-left">
					<img class="reviewer-img" th:src="@{/images/default-profile.png}"
						alt="프로필">
					<div class="review-content">
						<p class="review-name">
							리뷰 작성자: <span th:text="${review.reviewerId}"></span>
						</p>
						<p class="review-meta">
							<span
								th:text="${#temporals.format(review.createdAt, 'yyyy-MM-dd')}"></span>
						</p>
						<p class="stars">★★★★★</p>
						<p class="review-text" th:text="${review.comment}"></p>
						<div class="d-flex mt-2">
							<a th:href="@{/review/reviewUpdate(reviewId=${review.reviewId})}"
								class="btn btn-sm btn-outline-primary me-2">수정</a>
							<button class="btn btn-sm btn-outline-danger delete-review"
								th:data-review-id="${review.reviewId}">삭제</button>

						</div>
					</div>
				</div>
			</div>
		</div>

		<button class="write-review-btn"
			onclick="location.href='/review/reviewRegist?reviewedUserId=15'">✍
			리뷰 작성</button>



		<script
			src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	</div>
</body>

</html>