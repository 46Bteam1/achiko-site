<!DOCTYPE html>
<html
  lang="ko"
  xmlns:th="http://thymeleaf.org"
  xmlns:sec="http://thymeleaf.org/extras/spring-security"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Achiko</title>
    <link rel="icon" type="image/x-icon" th:href="@{/images/favicon.ico}" />

    <!-- CSS -->
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
      crossorigin="anonymous"
    />

    <!-- JavaScript -->
    <script th:src="@{/js/jquery-3.7.1.min.js}"></script>
    <script th:src="@{/js/index.js}" defer></script>

    <!-- google map -->
    <script
      async
      defer
      th:src="@{|https://maps.googleapis.com/maps/api/js?key=${googleApiKey}&libraries=places&callback=initMap&language=ja|}"
    ></script>

    <!-- <script th:inline="javascript">
      window.googleApiKeyFromServer = /*[[${googleApiKey}]]*/ "";
    </script> -->
  </head>

  <body>
    <!-- Ìó§Îçî header -->
    <header th:replace="~{fragments/headerTest :: header}"></header>

    <!-- Î©îÏù∏ Ïª®ÌÖêÏ∏† main -->
    <main>
      <article class="near-trip">
        <section id="listings-container" class="listings-grid">
          <div th:each="listing : ${shareList}" class="listing-card">
            <a
              th:href="@{/share/selectOne(shareId=${listing.shareId})}"
              class="listing-link"
            >
              <button
                class="favorite-btn"
                th:attr="data-id=${listing.shareId}"
                th:classappend="${listing.isFavorite} ? ' active' : ''"
              >
                <i
                  th:class="${listing.isFavorite} ? 'fas fa-heart' : 'far fa-heart'"
                ></i>
              </button>

              <!-- Ïù¥ÎØ∏ÏßÄ ÏòÅÏó≠ -->
              <th:block
                th:if="${listing.fileList != null and listing.fileList.size() > 0}"
              >
                <img th:src="${listing.fileList[0].fileUrl}" alt="Ïù¥ÎØ∏ÏßÄ" />
              </th:block>
              <th:block
                th:unless="${listing.fileList != null and listing.fileList.size() > 0}"
              >
                <img src="/images/default-profile.png" alt="Í∏∞Î≥∏ Ïù¥ÎØ∏ÏßÄ" />
              </th:block>

              <!-- Î∞© Ï†ïÎ≥¥ ÏòÅÏó≠ -->
              <div class="listing-info">
                <h3 th:text="${listing.title}"></h3>
                <div class="host-info">
                  <img
                    th:src="${listing.hostDTO.profileImage}"
                    alt="hostImage"
                  />
                  <div class="host-detail">
                    <span th:text="${listing.hostDTO.nickname}"></span>
                    <span
                      th:text="${listing.hostDTO.avgRating == 0.0 ? '‚≠ê ÏïÑÏßÅ Î¶¨Î∑∞Í∞Ä ÏóÜÎäî Ìò∏Ïä§Ìä∏ÏûÖÎãàÎã§':'‚≠ê'+listing.hostDTO.avgRating}"
                    ></span>
                  </div>
                </div>
                <p
                  th:text="${listing.regionName + ' ' + listing.cityName + ' ' + listing.townName}"
                ></p>
                <p>
                  ‚Ç©
                  <span
                    th:text="${#numbers.formatInteger(listing.price, 3, 'COMMA')}"
                  ></span>
                  / Ïõî
                </p>
                <p
                  th:text="'Ïù∏Ïõê: ' + ${listing.currentGuests} + ' / ' + ${listing.maxGuests} + 'Î™Ö'"
                ></p>
              </div>
            </a>
          </div>
        </section>
      </article>

      <!-- google map (Íµ¨Í∏Ä Îßµ) -->
      <article id="mapContainer" style="display: none">
        <div id="googleMap"></div>
      </article>
      <button id="mapButton">üå∏ÏßÄÎèÑ ÌëúÏãúÌïòÍ∏∞üå∏</button>
    </main>

    <!-- Ìë∏ÌÑ∞ -->
    <footer th:replace="~{fragments/footerTest :: footer}"></footer>
  </body>
</html>
